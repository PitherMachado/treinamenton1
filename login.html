<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Login • N1 Treinamento</title>
  <meta name="description" content="Acesso interno • N1 Treinamento" />
  <link rel="stylesheet" href="./style.css" />
</head>

<body class="auth-page">

  <div class="bg-glow" aria-hidden="true"></div>

  <main class="auth-wrap">
    <section class="auth-card" aria-label="Login N1">

      <p class="auth-kicker">N1 • ÁREA DE TREINAMENTO</p>
      <h1 class="auth-title">Acessar Plataforma</h1>
      <p class="auth-subtitle">Entre para continuar seus módulos.</p>

      <form id="loginForm" class="auth-form" autocomplete="on" novalidate>

        <div class="field">
          <label for="loginUser">Usuário</label>
          <input
            id="loginUser"
            type="text"
            placeholder="ex: pither"
            autocomplete="username"
            required
          />
        </div>

        <div class="field">
          <label for="loginPass">Senha</label>
          <input
            id="loginPass"
            type="password"
            placeholder="••••••"
            autocomplete="current-password"
            required
          />
        </div>

        <p id="loginError" class="form-error" role="alert"></p>

        <button class="btn btn-primary btn-full" type="submit">
          Entrar
        </button>

        <p class="auth-footnote">
          Acesso interno • GitHub Pages (Caminho 1)
        </p>

      </form>
    </section>
  </main>

  <!-- USERS -->
  <script src="./assets/js/users.js"></script>

  <!-- APP CORE -->
  <script src="./assets/js/app.js"></script>

  <script>
    // Se já estiver logado, vai direto
    if (window.N1Auth.isAuthed()) {
      window.location.href = "app/dashboard.html";
    }

    const form = document.getElementById("loginForm");
    const err  = document.getElementById("loginError");

    function setError(msg){
      err.textContent = msg || "";
    }

    form.addEventListener("submit", function(e){
      e.preventDefault();
      setError("");

      const user = document.getElementById("loginUser").value.trim();
      const pass = document.getElementById("loginPass").value.trim();

      if(!user || !pass){
        setError("Preencha usuário e senha.");
        return;
      }

      const success = window.N1Auth.login(user, pass);

      if(!success){
        setError("Usuário ou senha inválidos.");
        return;
      }

      window.location.href = "app/dashboard.html";
    });
  </script>

</body>
</html>
